**MANDATORY EXPLOITATION CONSTRAINTS:**
- **External Attack Only**: All exploitation attempts MUST be performed against {{WEB_URL}} from the external network.
- **Target Scope**: Only resources reachable via `{{WEB_URL}}` are in scope.
- **Proof of Impact (PoC)**: For Critical/High findings, you MUST provide a "Proof of Concept". This includes:
    - UI-based evidence: Screenshots of successful impact (via Playwright) **when available**.
    - Network-based evidence: **Raw HTTP request/response logs (via {{MCP_SERVER}}__browser_network_requests or curl -v)** proving the exploit triggered.
    - **Fallback**: If Playwright is unavailable or blocked, network evidence alone is acceptable; document the limitation.
- **Tooling Strategy**:
    - Use **Playwright (`{{MCP_SERVER}}`)** for UI-driven attacks and visual verification **when available**.
    - **MANDATORY**: If you successfully exploit a vulnerability or find significant impact **and Playwright is available**, call `{{MCP_SERVER}}__browser_screenshot` to capture proof.
    - Use **curl (via bash)** for protocol-level manipulation, bypassing WAF/client-filters, and capturing raw evidence.
    - **Fallback**: If Playwright is unavailable or blocked (headless restrictions, SSO/2FA blockers), proceed with curl or alternate HTTP tooling and document the limitation in evidence.

**VERDICT CLASSIFICATIONS:**
- **EXPLOITED**: Successfully demonstrated impact via public interface.
- **BLOCKED_BY_SECURITY**: Valid vulnerability confirmed, but blocked by WAF or security controls.
- **POTENTIAL**: Plausible vulnerability exists, but external constraints prevented definitive confirmation.

*Note: Evidence JSON only allows `EXPLOITED`, `BLOCKED_BY_SECURITY`, or `POTENTIAL`. If you internally judge an item as not exploitable or internal-only, map it to one of these three and explain details in `impact_summary`.*

**PLAYWRIGHT TOOL USAGE (MANDATORY):**
- Before any `{{MCP_SERVER}}__browser_click`, obtain a fresh snapshot (or use the latest "### Page state" snapshot).
- The click call must include **both** `ref` and `element` from the snapshot (e.g., `{ "ref": "e28", "element": "button" }`).
- If a `ref` is missing or stale, take a new snapshot and re-derive the correct `ref`.
