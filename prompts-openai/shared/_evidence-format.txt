### STANDARDIZED EVIDENCE FORMAT (MANDATORY)

You MUST save all exploitation evidence as a **JSON object** using the `save_deliverable` tool with the appropriate `*_EVIDENCE` type. This enables automated verification and reporting.

**CRITICAL: REQUIRED FIELDS (Validation will FAIL if missing):**
- `vulnerability_id`: Must match the ID from your queue (e.g., `SQLI-VULN-01`).
- `verdict`: MUST be exactly one of: `EXPLOITED`, `BLOCKED_BY_SECURITY`, or `POTENTIAL`.
- `evidence`: An array of evidence items.
- `reproduction_steps`: An array of strings explaining how to reproduce the vuln.

**JSON Schema Requirements:**
The top-level object must contain a `vulnerabilities` array.

```json
{
  "vulnerabilities": [
    {
      "vulnerability_id": "ID-From-Queue (e.g., AUTH-VULN-01)",
      "vulnerability_name": "Human Readable Name",
      "verdict": "EXPLOITED | BLOCKED_BY_SECURITY | POTENTIAL",
      "evidence": [
        {
          "type": "http_request_response",
          "description": "Initial login attempt",
          "request": {
            "method": "POST",
            "url": "https://...",
            "headers": { "Content-Type": "application/json" },
            "body": "{\"user\":\"admin\"}"
          },
          "response": {
            "status": 200,
            "headers": { "Set-Cookie": "session=..." },
            "body": "{\"status\":\"success\"}"
          }
        },
        {
          "type": "screenshot",
          "description": "Visual proof of impact",
          "path": "deliverables/findings/[vuln-type]/screenshot.png"
        },
        {
          "type": "session_state",
          "description": "Captured session markers",
          "cookies": [ { "name": "session", "value": "[REDACTED]" } ],
          "localStorage": { "token": "[REDACTED]" }
        }
      ],
      "reproduction_steps": [
        "1. Open login page",
        "2. Intercept request...",
        "3. ..."
      ],
      "impact_summary": "Successfully bypassed MFA by manipulating the 'step' parameter in the login flow."
    }
  ]
}
```

**CRITICAL RULES:**
1. **JSON Only**: The `content` parameter for `save_deliverable` MUST be a valid JSON string when saving `*_EVIDENCE` types.
2. **Queue-Empty Exception**: If the exploitation queue is truly empty, `{"vulnerabilities":[]}` is allowed. Otherwise include one entry per processed queue item.
3. **Full context**: Every HTTP request must include the full URL and all necessary headers.
4. **Sensitive data**: Mask passwords/codes with `[REDACTED]`.
5. **Tooling**: Use `TaskAgent` to automate evidence collection where possible.
6. **Screenshots**: If you use Playwright, ALWAYS take a screenshot of the final success state and include it in the JSON.
7. **If a required tool is unavailable**: Explain the limitation in `impact_summary` and add a reproduction step describing the constraint. Do **NOT** invent new evidence types.
8. **No fabricated evidence**: Only include responses you actually observed from tool output. If the command failed, record the failure and re-run; do not invent status codes or bodies.
9. **Evidence item shape**: Evidence entries MUST be objects with `type` and `description`. Do NOT use plain strings.
10. **Verdict constraints**: Only `EXPLOITED`, `BLOCKED_BY_SECURITY`, or `POTENTIAL` are valid. If you internally use labels like `FALSE_POSITIVE`, `NOT_VULNERABLE`, `ATTEMPTED - FAILED`, or `OUT_OF_SCOPE_INTERNAL`, map them before saving.
11. **Allowed evidence types**: Use only `http_request_response`, `screenshot`, or `session_state` unless you have a concrete, tool-produced artifact that clearly fits another type. Do NOT use `log` as a type.
