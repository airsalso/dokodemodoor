authentication:
  login_type: "form"
  login_url: "http://172.20.208.1:3002/#/login"
  credentials:
    username: "admin@juice-sh.op"
    password: "admin123"
    totp_code: "000000"
  login_flow:
    - "1. Navigate to http://172.20.208.1:3002/#/login"
    - "2. (If Popup) Dismiss Welcome Modal: Click 'Close Welcome Banner'. If it is not visible or click times out once, note it and continue."
    - "3. (If Popup) Dismiss Cookie Banner: Click 'Me want it!'. If it is not visible or click times out once, note it and continue."
    - "4. Enter Email: Click input#email first to focus, then type 'admin@juice-sh.op'."
    - "5. Enter Password: Click input#password first to focus, then type 'admin123'."
    - "6. Enable Login Button: Press 'Tab' (browser_press_key) to trigger Angular validation. Ensure button#loginButton is no longer disabled."
    - "7. Click Login: Click button#loginButton."
    - "8. Confirm: Wait for URL to include '/#/search'."
  success_condition:
    type: "url_contains"
    value: "/#/search"
rules:
  avoid:
    - description: "Avoid risky operation"
      type: "path"
      url_path: "/snippets/*"
    - description: "Static assets and library files"
      type: "path"
      url_path: "/assets/*"
  focus:
    - description: "Handles user account creation and retrieval. Critical for authentication and authorization; must enforce strict access controls and input validation to prevent injection and privilege escalation."
      type: "path"
      url_path: "/api/Users*"
    - description: "Manages user shipping addresses. Sensitive personal data; requires encryption at rest and secure handling to avoid data leakage or tampering."
      type: "path"
      url_path: "/api/Addresses*"
    - description: "Stores and retrieves payment method information. Must protect card data with PCI compliance measures and ensure that only the owning user can access or modify entries."
      type: "path"
      url_path: "/api/Cards*"
    - description: "Exposes product catalog and reviews. While not highly sensitive, it is a primary attack surface for injection and XSS; proper sanitization is essential."
      type: "path"
      url_path: "/api/Products*"
    - description: "Processes order placement and status. Contains financial and personal data; requires transaction integrity and audit logging to detect fraud."
      type: "path"
      url_path: "/api/Orders*"
    - description: "Provides user profile operations such as password change and identity verification. Must enforce authentication and rate limiting to mitigate brute‑force attacks."
      type: "path"
      url_path: "/rest/user*"
    - description: "Exposes application configuration and version information. Should be restricted to privileged roles to prevent information disclosure and configuration tampering."
      type: "path"
      url_path: "/rest/admin*"
    - description: "Handles NFT-related interactions. Involves blockchain operations; must validate signatures and prevent replay or unauthorized minting."
      type: "path"
      url_path: "/rest/web3*"
    - description: "Manages two‑factor authentication status and setup. Critical for multi‑factor security; must ensure tokens are short‑lived and protected from replay."
      type: "path"
      url_path: "/rest/2fa*"
    - description: "Manages shopping cart contents. Requires session integrity and protection against CSRF to prevent unauthorized cart manipulation."
      type: "path"
      url_path: "/rest/basket*"
