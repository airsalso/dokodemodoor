authentication:
  login_type: "form"
  login_url: "http://172.20.208.1:3002/#/login"
  credentials:
    username: "admin@juice-sh.op"
    password: "admin123"
  login_flow:
    - "1. Navigate to http://172.20.208.1:3002/#/login"
    - "2. (If Popup) Dismiss Welcome Modal: Click 'Close Welcome Banner'. If it is not visible or click times out once, note it and continue."
    - "3. (If Popup) Dismiss Cookie Banner: Click 'Me want it!'. If it is not visible or click times out once, note it and continue."
    - "4. Enter Email: Click input#email first to focus, then type 'admin@juice-sh.op'."
    - "5. Enter Password: Click input#password first to focus, then type 'admin123'."
    - "6. Enable Login Button: Press 'Tab' (browser_press_key) to trigger Angular validation. Ensure button#loginButton is no longer disabled."
    - "7. Click Login: Click button#loginButton."
    - "8. Confirm: Wait for URL to include '/#/search'."
  success_condition:
    type: "url_contains"
    value: "/#/search"
rules:
  focus:
    - description: "The POST /orders endpoint accepts order payloads that may contain unvalidated user input. This opens the door to injection attacks such as SQL or NoSQL injection, enabling attackers to manipulate business logic or exfiltrate data. Additionally, lack of proper authentication checks could allow unauthorized order creation, leading to financial loss or inventory tampering."
      type: "path"
      url_path: "/orders"
    - description: "The /profile/* group includes image upload functionality at /profile/image/file. File upload endpoints are notorious for allowing arbitrary file types, path traversal, and execution of malicious scripts if MIME type or content validation is insufficient. An attacker could upload a web shell or embed XSS payloads in image metadata, compromising the applicationâ€™s integrity."
      type: "path"
      url_path: "/profile/*"
    - description: "The generic /file-upload endpoint accepts arbitrary files without apparent restrictions. This can lead to remote code execution if the server processes uploaded files, or to the storage of malware that may later be served to users. Without strict size limits or content checks, the endpoint is a high-value target for attackers."
      type: "path"
      url_path: "/file-upload"
    - description: "The /metrics endpoint exposes internal system metrics, potentially revealing infrastructure details such as service versions, request rates, and health status. Information disclosure of this nature can aid attackers in crafting targeted exploits or mapping the attack surface. Lack of authentication or rate limiting further increases the risk of enumeration."
      type: "path"
      url_path: "/metrics"
    - description: "Endpoints under /rest/web3/ (submitKey, walletNFTVerify) interact with blockchain wallets. Improper validation of wallet addresses or private keys can lead to key leakage or replay attacks. If these endpoints are not protected against CSRF or do not enforce strict signature verification, attackers could hijack transactions or manipulate NFT ownership."
      type: "path"
      url_path: "/rest/web3/*"
    - description: "The /rest/memories endpoint is a scanning route that may return user-generated content. Without authentication, it can expose sensitive personal data, enabling social engineering or identity theft. The lack of access controls also increases the risk of data leakage during a breach."
      type: "path"
      url_path: "/rest/memories"
    - description: "The /rest/logfileServer endpoint provides access to server logs, which often contain stack traces, configuration details, and user credentials. Exposing logs without proper access control can facilitate credential dumping, forensic analysis, or the discovery of hidden vulnerabilities. Attackers could also use log data to refine phishing or credential stuffing attacks."
      type: "path"
      url_path: "/rest/logfileServer"
    - description: "The /rest/user/* group contains critical authentication and account management endpoints (login, reset-password, change-password, whoami, security-question, authentication-details, data-export). These endpoints are prime targets for brute force, credential stuffing, and password reset abuse. Inadequate rate limiting, weak password policies, or insecure data export mechanisms can lead to account takeover, personal data exposure, and session fixation."
      type: "path"
      url_path: "/rest/user/*"
  avoid:
    - description: "Static assets"
      type: "path"
      url_path: "/static/*"
    - description: "Logout endpoints"
      type: "path"
      url_path: "/logout*"
